<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>性能优化测量工具 | Jeffery Blog</title>
    <meta name="description" content="记录和分享技术">
    <link rel="icon" href="/images/photo.jpg">
  <link rel="manifest" href="/images/photo.jpg">
  <link rel="apple-touch-icon" href="/images/photo.jpg">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.83e51879.css" as="style"><link rel="preload" href="/assets/js/app.f96d0dc8.js" as="script"><link rel="preload" href="/assets/js/16.fe1d8458.js" as="script"><link rel="prefetch" href="/assets/js/10.8506b9fc.js"><link rel="prefetch" href="/assets/js/11.2ac88bab.js"><link rel="prefetch" href="/assets/js/12.ae3ae057.js"><link rel="prefetch" href="/assets/js/13.4a7cb9d2.js"><link rel="prefetch" href="/assets/js/14.50a65c01.js"><link rel="prefetch" href="/assets/js/15.2c09bf95.js"><link rel="prefetch" href="/assets/js/17.76935e2c.js"><link rel="prefetch" href="/assets/js/18.a3e9694d.js"><link rel="prefetch" href="/assets/js/19.d4d9a945.js"><link rel="prefetch" href="/assets/js/2.e1a2e5a6.js"><link rel="prefetch" href="/assets/js/20.c6f91d1d.js"><link rel="prefetch" href="/assets/js/21.9daaa140.js"><link rel="prefetch" href="/assets/js/22.706a5717.js"><link rel="prefetch" href="/assets/js/23.b55e5f59.js"><link rel="prefetch" href="/assets/js/24.e57fd181.js"><link rel="prefetch" href="/assets/js/25.de753c09.js"><link rel="prefetch" href="/assets/js/26.75e03a0a.js"><link rel="prefetch" href="/assets/js/27.0f39ac24.js"><link rel="prefetch" href="/assets/js/28.b4f1e26a.js"><link rel="prefetch" href="/assets/js/29.7e147ce9.js"><link rel="prefetch" href="/assets/js/3.fca730b7.js"><link rel="prefetch" href="/assets/js/30.08287792.js"><link rel="prefetch" href="/assets/js/31.4a26cbda.js"><link rel="prefetch" href="/assets/js/32.5b443424.js"><link rel="prefetch" href="/assets/js/33.4fd4b08b.js"><link rel="prefetch" href="/assets/js/34.a31c0f36.js"><link rel="prefetch" href="/assets/js/35.88cafe94.js"><link rel="prefetch" href="/assets/js/36.7812381a.js"><link rel="prefetch" href="/assets/js/37.5f9f2adb.js"><link rel="prefetch" href="/assets/js/38.118ba1f4.js"><link rel="prefetch" href="/assets/js/39.b67f7277.js"><link rel="prefetch" href="/assets/js/4.9e7532a1.js"><link rel="prefetch" href="/assets/js/40.e55debb3.js"><link rel="prefetch" href="/assets/js/41.d7903d06.js"><link rel="prefetch" href="/assets/js/42.77614d76.js"><link rel="prefetch" href="/assets/js/43.b81eee3a.js"><link rel="prefetch" href="/assets/js/44.4ade92d1.js"><link rel="prefetch" href="/assets/js/45.8bea4d57.js"><link rel="prefetch" href="/assets/js/46.3bdb04e6.js"><link rel="prefetch" href="/assets/js/47.c894c4b2.js"><link rel="prefetch" href="/assets/js/48.78e60e2b.js"><link rel="prefetch" href="/assets/js/49.9c5c8f7d.js"><link rel="prefetch" href="/assets/js/5.a3c90268.js"><link rel="prefetch" href="/assets/js/50.832279c4.js"><link rel="prefetch" href="/assets/js/51.cc16f222.js"><link rel="prefetch" href="/assets/js/52.b28aa4d0.js"><link rel="prefetch" href="/assets/js/53.ebabf090.js"><link rel="prefetch" href="/assets/js/54.28bdfc99.js"><link rel="prefetch" href="/assets/js/55.a1b4df06.js"><link rel="prefetch" href="/assets/js/56.6fb0c31d.js"><link rel="prefetch" href="/assets/js/57.b9df5c2d.js"><link rel="prefetch" href="/assets/js/58.47940a92.js"><link rel="prefetch" href="/assets/js/6.4133d95a.js"><link rel="prefetch" href="/assets/js/7.ea728375.js"><link rel="prefetch" href="/assets/js/8.b6825a68.js"><link rel="prefetch" href="/assets/js/9.4d493f14.js">
    <link rel="stylesheet" href="/assets/css/0.styles.83e51879.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jeffery Blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue-home.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/web/javascript/home.html" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/web/typescript/guide.html" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/web/html/" class="nav-link">HTML</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vscode/shortcut-key.html" class="nav-link">VS Code</a></li><li class="dropdown-item"><!----> <a href="/tools/git/basics.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/tools/gitlab/webhook.html" class="nav-link">GitLab</a></li><li class="dropdown-item"><!----> <a href="/tools/develop/doc.html" class="nav-link">工具库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端基建</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/infrastructure/performance/01-optimize-index.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/JefferyXZF" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/vue-home.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/web/javascript/home.html" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/web/typescript/guide.html" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/web/html/" class="nav-link">HTML</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/vscode/shortcut-key.html" class="nav-link">VS Code</a></li><li class="dropdown-item"><!----> <a href="/tools/git/basics.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/tools/gitlab/webhook.html" class="nav-link">GitLab</a></li><li class="dropdown-item"><!----> <a href="/tools/develop/doc.html" class="nav-link">工具库</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端基建</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/infrastructure/performance/01-optimize-index.html" class="nav-link">性能优化</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/JefferyXZF" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/infrastructure/performance/01-optimize-index.html" class="sidebar-link">性能优化指标</a></li><li><a href="/infrastructure/performance/02-optimize-tool.html" aria-current="page" class="active sidebar-link">性能优化工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/infrastructure/performance/02-optimize-tool.html#chrome-devtools" class="sidebar-link">Chrome DevTools</a></li><li class="sidebar-sub-header"><a href="/infrastructure/performance/02-optimize-tool.html#lighthouse" class="sidebar-link">Lighthouse</a></li><li class="sidebar-sub-header"><a href="/infrastructure/performance/02-optimize-tool.html#web-page-test" class="sidebar-link">Web Page Test</a></li></ul></li><li><a href="/infrastructure/performance/03-optimize-image.html" class="sidebar-link">图片资源优化</a></li><li><a href="/infrastructure/performance/04-render-optimize.html" class="sidebar-link">渲染优化</a></li><li><a href="/infrastructure/performance/05-webpack-optimize.html" class="sidebar-link">webpack构建优化</a></li><li><a href="/infrastructure/performance/06-network-optimize.html" class="sidebar-link">网络传输优化</a></li><li><a href="/infrastructure/performance/07-cache-optimize.html" class="sidebar-link">缓存优化</a></li><li><a href="/infrastructure/performance/08-code-optimize.html" class="sidebar-link">代码优化</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="性能优化测量工具"><a href="#性能优化测量工具" class="header-anchor">#</a> 性能优化测量工具</h1> <p>知道性能优化指标后，需要通过工具来测量出这些指标，网上有很多测试性能指标的工具，这里列出一些常用的工具</p> <ul><li><a href="https://developers.google.com/web/tools/chrome-devtools?hl=zh-cn" target="_blank" rel="noopener noreferrer">Chrome DevTools network，performance 面板<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developers.google.com/web/tools/lighthouse?hl=zh-cn" target="_blank" rel="noopener noreferrer">Lighthouse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.webpagetest.org/" target="_blank" rel="noopener noreferrer">Web Page Test<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://developers.google.com/speed/pagespeed/insights/" target="_blank" rel="noopener noreferrer">PageSpeed Insights<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://gtmetrix.com/" target="_blank" rel="noopener noreferrer">GTmetrix<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://google.github.io/tracing-framework/" target="_blank" rel="noopener noreferrer">Tracing-framework by Google<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>接下来以 Chrome DevTools、LightHouse、Web Page Test 工具的使用来分析页面性能指标</p> <h2 id="chrome-devtools"><a href="#chrome-devtools" class="header-anchor">#</a> Chrome DevTools</h2> <h3 id="performance-面板"><a href="#performance-面板" class="header-anchor">#</a> performance 面板</h3> <ul><li>浏览器打开新的无痕窗口，进入隐身模式，使用无痕模式是为了避免相关的浏览器插件带来的干扰。</li></ul> <p><img src="/images/performance/%E6%97%A0%E7%97%95%E6%A8%A1%E5%BC%8F.jpg" alt="无痕模式"></p> <ul><li>按F12进入开发者工具，打开 <code>performance</code> 面板。</li></ul> <p><img src="/images/performance/performance-pane.png" alt="performance 面板"></p> <ul><li><p>上图中 performance 面板英文告诉我们如何使用这个面板了，点击最左侧的黑色圆开始一个新的监测记录，也可以点击刷新按钮记录整个刷新过程中的监测记录。然后右侧我们如果勾选了Screenshots，可以记录整个监测过程中每一帧的截图。如果勾选了Memory，可以看到内存的详细使用情况以及垃圾回收的周期，也可以观察到内存有无泄漏的情况。</p></li> <li><p>点击最右侧的小齿轮，可以看到一些配置项，打开 CPU 的节流开关，可以模拟移动端项目。打开 Network 的节流开关，我们模拟弱网(2g/3g)条件下网站的一些表现情况，然后根据弱网的具体表现进行相关优化。</p></li></ul> <p><strong>案例分析（淘宝）</strong></p> <p><img src="/images/performance/performance-screen.gif" alt="performance案例分析"></p> <p>上面是简单的录屏，接下来分析一下加载过程中的性能表现：</p> <p><img src="/images/performance/performance-analyse.png" alt="performance案例分析"></p> <p>上面可以直观地看到页面的整个加载过程，右侧是3个关键的指标：</p> <ul><li><strong>FPS</strong>：这个指标是衡量动画是否流畅的一个重要指标。图中的绿色柱状图很高，这就代表 FPS 帧率很高，体验也就越流畅，如果 FPS 帧率较低，那么图中则会是红色的横条，表明帧率较低，影响用户体验，这里图中并没有出现红色，说明淘宝网页的整个体验非常流畅的。</li> <li><strong>CPU</strong>: 这个指标和下面的 Summary 指标是一一对应，而且这里它们的颜色所代表含义也是相同的，每个颜色代表各个过程所耗费的时间。从图中我们可以看到，整个加载过程中，最大对应的是橙色脚本加载时间，可以试着从加快脚本加载速度方面去优化。第二大占比是紫色部分，Rendering 渲染时间。</li> <li><strong>NET</strong>：这个是展示各个请求所花费的具体时间。可以直接去 Network 面板当中去具体观察各个请求所花费的时间，然后针对具体的请求具体分析。</li></ul> <p><img src="/images/performance/performance-main.png" alt="performance案例分析"></p> <p>上图是主线程加载情况，图中各种颜色的矩形代表加载过程中做的所有工作。横轴代表时间，纵轴代表具体的调用堆栈。调用堆栈就像是浏览器当中的解释器，我们可以利用它追踪函数的执行流。当浏览器中调用了多个函数，通过这种机制可以追踪到哪个函数正在执行，具体函数体中又调用了哪个函数。这里我们随便点击一个矩形，如下图：</p> <p><img src="/images/performance/performance-main-time.png" alt="performance案例分析"></p> <p>点击之后我们看到了这个事件下对应的一些具体信息，这里我们还可以点击Range右侧链接，点击之后会直接跳到sources面板对应的代码位置，这个功能可以说大大方便了我们定位具体的代码。</p> <p>最下面的区域分为4个tab，Summary 与统计总览区域面板 CPU 相对应，Bottom-Up 则是代表调用堆栈的前后调用关系，Call Tree 是调用树，最后的 Event Log 则是事件日志。这个区域用到的情况不多，更多的是辅助作用</p> <h3 id="network-面板"><a href="#network-面板" class="header-anchor">#</a> Network 面板</h3> <p>网络面板可以帮助我们查看请求过程</p> <p><img src="/images/performance/network.png" alt="performance案例分析"></p> <p>上图，Waterfall 瀑布图部分可以查看所有资源的请求顺序，加载时间等信息，可以进行资源大小的排序，加载时间的排序，资源的大小，这样就能针对性分析页面的性能，找出性能的瓶颈，优化我们的页面</p> <p><img src="/images/performance/network-analyse.png" alt="performance案例分析.jpg"></p> <p>上图，很直观的从中找到我们想要的资源信息</p> <h2 id="lighthouse"><a href="#lighthouse" class="header-anchor">#</a> Lighthouse</h2> <p><code>Performance</code> 面板和 <code>Network</code> 面板，虽然给我们提供了很多有用的信息，但是不够直观，需要开发者透过表面的这些参数去分析背后的性能问题，为了解决这个问题，接下来介绍另一个非常强大的性能优化工具 <code>Lighthouse</code>，这也是我经常用的一个工具。</p> <p>Lighthouse 是 Google 开源的一个自动化工具，用于改进网络应用的质量。你可以将其作为一个 Chrome 扩展程序运行，或从命令行运行。 当为 Lighthouse 提供一个要审查的网址，它将针对此页面运行一连串的测试，然后生成一个有关页面性能的报告。可以参考失败的测试，看看可以采取哪些措施来改进应用。</p> <p><strong>优点</strong></p> <ul><li>评分报告全面且具有一定的权威性</li> <li>提供解决方案</li> <li>发现大的性能问题</li></ul> <p><strong>缺点</strong></p> <ul><li>测试环境较单一，用户群体的环境各有不同，不可以一概之</li> <li>存在「波动」，不同时刻的访客群体存在差异，数据只能反应当前时刻的「效果」</li></ul> <h3 id="lighthouse-环境安装"><a href="#lighthouse-环境安装" class="header-anchor">#</a> Lighthouse 环境安装</h3> <p><strong>Lighthouse 有三种方式使用</strong></p> <ul><li>1、直接在 Chrome DevTools 的 Lighthouse 面板使用</li></ul> <p><img src="/images/performance/google-lighthouse.png" alt="performance案例分析.jpg"></p> <ul><li>2、在 Google 应用商店下载 Lighthouse 插件</li></ul> <p><img src="/images/performance/lighthouse-plugin.png" alt="performance案例分析.jpg"></p> <ul><li>3、最后一种，使用 Node CLI 命令行进行安装和运行，使用如下命令</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install <span class="token operator">-</span>g lighthouse
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>命令行支持导出 <code>HTML</code> 格式和 <code>JSON</code> 格式，我们使用如下命令分别导出：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//生成报告并在浏览器中打开</span>
lighthouse https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>taobao<span class="token punctuation">.</span>com<span class="token operator">/</span> <span class="token operator">--</span>view  

<span class="token comment">//报告格式是json，保存在当前目录</span>
lighthouse https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>taobao<span class="token punctuation">.</span>com<span class="token operator">/</span> <span class="token operator">--</span>output<span class="token operator">=</span>json <span class="token operator">--</span>output<span class="token operator">-</span>path<span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">/</span>report<span class="token punctuation">.</span>json

<span class="token comment">//设置浏览器的窗口尺寸//</span>
lighthouse https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>taobao<span class="token punctuation">.</span>com<span class="token operator">/</span> <span class="token operator">--</span>chrome<span class="token operator">-</span>flags<span class="token operator">=</span><span class="token string">&quot;--window-size=1190,660&quot;</span>

<span class="token comment">//模拟器设为桌面</span>
lighthouse https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>taobao<span class="token punctuation">.</span>com<span class="token operator">/</span> <span class="token operator">--</span>emulated<span class="token operator">-</span>form<span class="token operator">-</span>factor<span class="token operator">=</span>desktop

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="性能报告"><a href="#性能报告" class="header-anchor">#</a> 性能报告</h3> <ul><li>Perfermance 性能分析</li> <li>Accessibility 可访问性</li> <li>Best Practices 最佳实践</li> <li>SEO 搜索引擎优化</li> <li>Progressive Web App 是否集成pwa</li></ul> <h3 id="案例分析"><a href="#案例分析" class="header-anchor">#</a> 案例分析</h3> <p>以淘宝网为例，使用 LightHouse 来生成性能优化测试的报告</p> <p><img src="/images/performance/taobao-lighthouse.png" alt="淘宝案例分析.jpg"></p> <p>可以看到报告详细给出了各种情况下的分数情况，从左到右分别是Performance(页面性能)、Accessibility(可访性)、Best Practise(最佳实践)、SEO(搜索引擎优化)、Progressive Web App(渐进式应用)。点击其中的每一项都可以看到给出的具体优化建议</p> <p><strong>Performance 页面性能</strong></p> <p><img src="/images/performance/light-performance.png" alt="淘宝案例分析.jpg"></p> <p>从中也看到了前面提到的几个重要性能指标：FCP, Speed Index, LCP, TTI, TBT, CLS</p> <ul><li>First Contentful Paint：首次内容绘制时间</li> <li>Speed Index：速度指标</li> <li>Largest Contentful Paint：最长内容绘制时间</li> <li>Time to Interactive：可交互时间</li> <li>Total Blocking Time：总的阻塞时间</li> <li>Cumulative Layout Shift：累计布局偏移</li></ul> <p>上图可以看到淘宝页面性能得分 44分（满分100分），这个得分受到很多方面的影响，作为参考即可。</p> <p>可以看到指标的时间数值的颜色不一样，有些是红色，有些是绿色。时间显示红色表示性能有瓶颈，橙色表示性能还可以，绿色表示性能非常好</p> <p><strong>页面加载过程</strong></p> <p><img src="/images/performance/lighthouse-load.png" alt="淘宝案例分析"></p> <p>上图显示淘宝页加载过程，很明显看得出淘宝页面使用骨架屏渐进式显示，用户体验很好</p> <p><strong>Opportunities 优化建议</strong></p> <p><img src="/images/performance/light-opport.png" alt="淘宝案例分析"></p> <p>以上一共有 2 条优化建议，移除无用的脚本和避免重定向，看得出淘宝的首页优化的非常的好。</p> <p>你也可以拿你们公司的网站来测试，然后根据它列出的建议一条一条优化你们的网站</p> <h2 id="web-page-test"><a href="#web-page-test" class="header-anchor">#</a> Web Page Test</h2> <p>介绍最后一个第三方免费但也非常强大的性能测试工具 <a href="https://www.webpagetest.org/" target="_blank" rel="noopener noreferrer">WebPageTest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>对我而言，它相比 Lighthouse 有什么优点呢</p> <ul><li>提供海外多个站点测试，这对国外网络访问网站测试很有用</li> <li>可以测试前后连续两次访问的结果，这样容易比较，分析缓存性能问题</li> <li>可以录制视频，提供的数据更全面和直观</li></ul> <p><img src="/images/performance/webpage-test-home.png" alt="淘宝案例分析.jpg"></p> <p>测试启动加载过程</p> <p><img src="/images/performance/webpage-loading.png" alt="淘宝案例分析.jpg"></p> <p><strong>WebPageTest 测试结果分析</strong></p> <p><a href="https://www.webpagetest.org/result/201112_DiHE_ceeb90f47702ebe460d1edb4fe225b6c/" target="_blank" rel="noopener noreferrer">测试结果链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>测试结果页面有一个导航栏，切换可以查看多个方面性能结果</p> <ul><li>Summary: 测试结果总览页面，查看录制视频c</li> <li>Details: 测试详情页面, 查看网络请求瀑布图，资源加载情况</li> <li>Performance Review: 页面性能分析， Keep-Alive, GZip, Compress Img, Progressive, Cache Static, CDN Detected 等</li> <li>Content Breakdown: 内容分解，饼图分析</li> <li>Domains: 按域划分的内容</li> <li>Processing Breakdown: 主线程运行情况分析</li> <li>Image Analysis: 图片资源分析</li> <li>Request Map: 站点请求映射</li></ul> <p>关于怎么分析页面性能的指标，它的瀑布图和分析步骤和之前分析的一样，这里就不赘述。</p> <p><img src="/images/performance/webpack-test-detail.png" alt="淘宝案例分析.jpg"></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/infrastructure/performance/01-optimize-index.html" class="prev">
          性能优化指标
        </a></span> <span class="next"><a href="/infrastructure/performance/03-optimize-image.html">
          图片资源优化
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.f96d0dc8.js" defer></script><script src="/assets/js/16.fe1d8458.js" defer></script>
  </body>
</html>
