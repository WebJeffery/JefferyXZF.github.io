(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{196:function(s,t,a){"use strict";a.r(t);var e=a(0),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[s._m(0),s._v(" "),a("p",[s._v("这里的构建优化主要是针对 webpack 构建工具的优化，webpack 优化主要分为：构建速度优化和打包体积优化")]),s._v(" "),s._m(1),s._v(" "),s._m(2),s._v(" "),a("p",[s._v("webpack 查找文件会根据依赖和配置进行查找，缩小查找文件范围会提高我们的构建速度，以下列出几种做法：")]),s._v(" "),s._m(3),s._v(" "),s._m(4),s._v(" "),a("p",[s._v("预先编译和打包不会变动存在的文件，在业务代码中直接引入，加快 Webpack 编译打包的速度，但是并不能减少最后生成的代码体积。")]),s._v(" "),s._m(5),s._v(" "),a("p",[s._v("有两种方案：thread-loader 和 HappyPack")]),s._v(" "),s._m(6),s._v(" "),s._m(7),s._v(" "),s._m(8),s._m(9),s._v(" "),a("p",[s._v("使用terser-webpack-plugin 的时候可以通过下面的配置开启多线程和缓存：")]),s._v(" "),s._m(10),s._m(11),s._v(" "),s._m(12),s._v(" "),s._m(13),s._v(" "),s._m(14),s._v(" "),s._m(15),s._v(" "),s._m(16),s._m(17),s._v(" "),s._m(18),s._v(" "),s._m(19),s._m(20),s._v(" "),s._m(21),s._v(" "),s._m(22),s._v(" "),a("p",[s._v("按照字面翻译过来是摇树，意思是把树上没用的叶子摇落下来，具体到代码中表现为删除无用重复的代码。")]),s._v(" "),a("p",[s._v("移除 JavaScript 上下文中没用的代码，这样可以有效地缩减打包体积")]),s._v(" "),a("p",[s._v("使用前提和配置：")]),s._v(" "),s._m(23),s._v(" "),s._m(24),s._v(" "),a("p",[s._v("作用域提升（Scope Hoisting）是指 webpack 通过 ES6 语法的静态分析，分析出模块之间的依赖关系，尽可能地把模块放到同一个函数中。")]),s._v(" "),a("p",[s._v("开启了 Scope Hoisting")]),s._v(" "),s._m(25),s._m(26),s._v(" "),s._m(27),s._v(" "),s._m(28),s._v(" "),s._m(29),s._v(" "),s._m(30),s._v(" "),a("p",[s._v("使用多个入口文件，打包到不同的bundle文件中，也可以减少打包体积")]),s._v(" "),s._m(31),s._v(" "),a("p",[s._v("代码分割（Code Splitting）是指将项目代码构建打包（Bundler）后，根据指定规则分割成多个 bundles（输出文件），这些模块文件可以被按需动态加载或者并行加载，可以用来优化代码加载时的资源大小及优先级。正确使用代码分割，可以优化提升资源加载效率。")]),s._v(" "),s._m(32),s._v(" "),a("p",[s._v("前面提到，使用按需加载， ES6 新增的 import() 方法，会将我们的代码分割出来，具体使用如下：")]),s._v(" "),s._m(33),a("p",[s._v("这里 Webpack 配置的输出也要做对应的修改，如下：")]),s._v(" "),s._m(34),s._m(35),s._v(" "),s._m(36),s._v(" "),a("p",[s._v("具体配置可以参考 "),a("a",{attrs:{href:"https://webpack.docschina.org/plugins/split-chunks-plugin/#optimizationsplitchunks",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack 网站"),a("OutboundLink")],1)]),s._v(" "),s._m(37),s._v(" "),s._m(38),s._v(" "),a("p",[s._v("Tips：其实 webpack 4 中，在 production 模式下已经根据大多数项目的优化经验做了通用的配置，类似Tree-Shaking、Scope Hoisting 都是默认开启的，而且最新版本的 Webpack 使用的压缩工具就是 terser-webpack-plugin。")])])}),[function(){var s=this.$createElement,t=this._self._c||s;return t("h1",{attrs:{id:"webpack-构建优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#webpack-构建优化"}},[this._v("#")]),this._v(" webpack 构建优化")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"构建速度优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建速度优化"}},[this._v("#")]),this._v(" 构建速度优化")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"缩小文件查找范围"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缩小文件查找范围"}},[this._v("#")]),this._v(" 缩小文件查找范围")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ul",[a("li",[s._v("loader 匹配：使用 test，include，exclude（exclude优先级比include优先级高，建议优先使用 include）")]),s._v(" "),a("li",[s._v("优化 resolve.modules 配置，它默认是从 "),a("code",[s._v("node_modules")]),s._v(" 中查找")]),s._v(" "),a("li",[s._v("优化 resolve.mainFields 配置")]),s._v(" "),a("li",[s._v("使用 resolve.alias 重命名")]),s._v(" "),a("li",[s._v("resolve.extensions 优先查找")]),s._v(" "),a("li",[s._v("优化 module.noParse 配置")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"使用-webpack-dllplugin-来预先编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-webpack-dllplugin-来预先编译"}},[this._v("#")]),this._v(" 使用 webpack.DllPlugin 来预先编译")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"多线程和多进程打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多线程和多进程打包"}},[this._v("#")]),this._v(" 多线程和多进程打包")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[t("p",[this._v("thread-loader 是针对 loader 进行优化的，它会将 loader 放置在一个 worker 池里面运行，以达到多线程构建。\nthread-loader 在使用的时候，需要将其放置在其他 loader 之前")])]),this._v(" "),t("li",[t("p",[this._v("HappyPack 是通过多进程模型，来加速代码构建")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"使用自动刷新"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用自动刷新"}},[this._v("#")]),this._v(" 使用自动刷新")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("export "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 只有在开启监听模式时，watchOptions 才有意义  ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 默认为 false，也就是不开启  ")]),s._v("\n  watch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 监听模式运行时的参数 ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在开启监听模式时，才有意义  ")]),s._v("\n  watchOptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("    \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不监听的文件或文件夹，支持正则匹配   ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 默认为空   ")]),s._v("\n  ignored"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("node_modules")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//监听到变化发生后会等300ms再去执行动作，防止文件更新太快导致重新编译频率太高, 默认为 300ms    ")]),s._v("\n  aggregateTimeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 判断文件是否发生变化是通过不停的去询问系统指定文件有没有变化实现的    ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 默认每隔1000毫秒询问一次    ")]),s._v("\n  poll"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" \n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"压缩速度优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#压缩速度优化"}},[this._v("#")]),this._v(" 压缩速度优化")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" TerserPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"terser-webpack-plugin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  optimization"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  minimizer"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TerserPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 开启缓存")]),s._v("\n      parallel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 多线程")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"其他构建速度优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他构建速度优化"}},[this._v("#")]),this._v(" 其他构建速度优化")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[t("p",[this._v("sourceMap 生成耗时严重，根据之前 sourceMap[TODO](sourcemap 表格链接)表格选择合适的 devtool 值；")])]),this._v(" "),t("li",[t("p",[this._v("切换一些 loader 或者插件，比如：fast-sass-loader 可以并行处理 sass 文件，要比 sass-loader 快 5~10倍；")])]),this._v(" "),t("li",[t("p",[this._v("babel-loader 的 cacheDirectory")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"打包体积优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打包体积优化"}},[this._v("#")]),this._v(" 打包体积优化")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"javascript-压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#javascript-压缩"}},[this._v("#")]),this._v(" JavaScript 压缩")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("terser-webpack-plugin")]),this._v(" 这个插件很强大，除了开启多线程打包，还可以打包压缩，去除注释等无用打包，具体使用如下：")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TerserPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用 cache，加快二次构建速度")]),s._v("\n cache"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n terserOptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   comments"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   compress"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 删除无用的代码")]),s._v("\n  unused"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 删掉 debugger")]),s._v("\n drop_debugger"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// eslint-disable-line")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 移除 console")]),s._v("\n drop_console"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// eslint-disable-line")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 移除无用的代码")]),s._v("\n dead_code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// eslint-disable-line")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"css-优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#css-优化"}},[this._v("#")]),this._v(" CSS 优化")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[t("p",[this._v("使用 "),t("code",[this._v("mini-css-extract-plugin")]),this._v(" webpack 插件，从 js 文件中分离 CSS 到单独到文件，方便使用缓存")])]),this._v(" "),t("li",[t("p",[this._v("压缩 CSS：cssnano，css-loader 已经集成了 cssnano，还可以使用  "),t("code",[this._v("optimize-css-assets-webpack-plugin")]),this._v(" 来自定义 cssnano 的规则, 比如：删除空格和最后一个分号；删除注释；优化字体权重；丢弃重复的样式规则；压缩选择器；减少手写属性；合并规则；")])])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" OptimizeCssAssetsPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'optimize-css-assets-webpack-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" \n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OptimizeCssAssetsPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n      assetNameRegExp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.optimize\\.css$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n       cssProcessor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cssnano'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里制定了引擎，不指定默认也是 cssnano ")]),s._v("\n        cssProcessorPluginOptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n          preset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'default'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" discardComments"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("removeAll"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        canPrint"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"html-压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#html-压缩"}},[this._v("#")]),this._v(" html 压缩")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("可以使用 "),t("code",[this._v("html-webpack-plugin")]),this._v(" 这个插件配置压缩 "),t("code",[this._v("html")]),this._v(" 代码")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"tree-shaking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking"}},[this._v("#")]),this._v(" Tree-Shaking")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ul",[a("li",[s._v("减少代码中的副作用代码；")]),s._v(" "),a("li",[s._v("配置 sideEffects 告诉 webpack 模块是安全的，不会带有副作用，可以放心优化。")]),s._v(" "),a("li",[s._v("要使用 Tree-Shaking 必然要保证引用的模块都是 ES6 规范的")]),s._v(" "),a("li",[s._v("按需引入模块，避免「一把梭」，例如我们要使用 lodash 的 isNumber ，可以使用 "),a("code",[s._v("import isNumber from 'lodash-es/isNumber'")]),s._v("; ，而不是 "),a("code",[s._v("import {isNumber} from 'lodash-es'")]),s._v(" ；")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"scope-hoisting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scope-hoisting"}},[this._v("#")]),this._v(" Scope Hoisting")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  optimization"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     concatenateModules"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"图片打包优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#图片打包优化"}},[this._v("#")]),this._v(" 图片打包优化")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[t("p",[this._v("url-loader 设置 limit 转化为 Base64 减少请求，svg-url-loader 同理")])]),this._v(" "),t("li",[t("p",[this._v("雪碧图插件合并小图，减少请求")])]),this._v(" "),t("li",[t("p",[this._v("用 image-webpack-loader 等来打包压缩图片")])])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"按需加载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#按需加载"}},[this._v("#")]),this._v(" 按需加载")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("使用 "),t("code",[this._v("import()")]),this._v(" 和 "),t("code",[this._v("require.ensure()")]),this._v(" 动态导入函数，动态导入会划分到新的 bundle 打包文件中，从而减少主体打包文件体积")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"配置多个入口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置多个入口"}},[this._v("#")]),this._v(" 配置多个入口")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"代码分割（code-splitting）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码分割（code-splitting）"}},[this._v("#")]),this._v(" 代码分割（Code Splitting）")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("strong",[this._v("代码分割方案")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("Test1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/* webpackChunkName: "Test1" */')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./pages/Test1.vue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("Test2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/* webpackChunkName: "Test2" */')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./pages/Test2.vue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\toutput"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  \tchunkFilename"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[name].chunk.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("[webpackChunkName].chunk.js")]),this._v(" 就是打包的文件名了")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("strong",[this._v("splitChunks 实现代码分割")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"其他"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[this._v("#")]),this._v(" 其他")])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ul",[a("li",[s._v("合理划分代码职责，适当使用按需加载方案；")]),s._v(" "),a("li",[s._v("善用 webpack-bundle-analyzer 插件，帮助分析 Webpack 打包后的模块依赖关系；")]),s._v(" "),a("li",[s._v("设置合理的 SplitChunks 分组；")]),s._v(" "),a("li",[s._v("对于一些 UI 组件库，例如 AntDesign、ElementUI 等，可以使用bable-plugin-import这类工具进行优化；")]),s._v(" "),a("li",[s._v("使用 lodash、momentjs 这类库，不要一股脑引入，要按需引入，momentjs 可以用 date-fns 库来代替；")]),s._v(" "),a("li",[s._v("合理使用 hash 占位符，防止 hash 重复出现，导致文件名变化从而 HTTP 缓存过期；")]),s._v(" "),a("li",[s._v("合理使用 polyfill，防止多余的代码；")]),s._v(" "),a("li",[s._v("使用 ES6 语法，尽量不使用具有副作用的代码，以加强 Tree-Shaking 的效果；")]),s._v(" "),a("li",[s._v("使用 Webpack 的 Scope Hoisting（作用域提升）功能。")])])}],!1,null,null,null);t.default=n.exports}}]);